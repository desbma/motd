language: rust
matrix:
  include:
    - rust: stable
      env: BUILD=1 TEST=1 CLIPPY=1 RUSTFMT=1
    - rust: beta
      env: BUILD=1 TEST=1 CLIPPY=0 RUSTFMT=0
    - rust: beta
      env: BUILD=0 TEST=0 CLIPPY=1 RUSTFMT=1
    - rust: nightly
      env: BUILD=1 TEST=1 CLIPPY=0 RUSTFMT=0
    - rust: nightly
      env: BUILD=0 TEST=0 CLIPPY=1 RUSTFMT=1
  allow_failures:
    - rust: beta
      env: BUILD=0 TEST=0 CLIPPY=1 RUSTFMT=1
    - rust: nightly
before_script:
  - "if [ $CLIPPY -eq 1 ]; then rustup component add clippy; fi"
  - "if [ $RUSTFMT -eq 1 ]; then rustup component add rustfmt; fi"
script:
  - "if [ $BUILD -eq 1 ]; then cargo build --verbose --all; fi"
  - "if [ $TEST -eq 1 ]; then cargo test --verbose --all; fi"
  - "if [ $CLIPPY -eq 1 ]; then cargo clippy --all-targets --all-features -- -D warnings -A clippy::unreadable_literal; fi"
  - "if [ $RUSTFMT -eq 1 ]; then cargo fmt --all -- --check; fi"
notifications:
  email:
    recipients:
      - secure: "sHp7Ge5sLJCkO9LCLmf5PjGgkbOcYpmC7Fz0pYfquHskdf+PxEbIadDAaRqHDvxbo65v7UahSJBzdq9FHVK/khl4LJBQEs39g85Cs1yC2ImVMhVJ8iT9CuCj9em0DPaR7/fsqd5uvZNaMOyKifeResbsvupA4lVtdUKPmmDut3ey22SE8ypddtFedq2lrUdKVSUVjF8PL45fsdqlrtOtELbwybHqZV3umyzrk0lHb/33dLPuad1UBHE4lJdZCbDeIfEza+Hr30zgG13UhfVj9wqyE3ctgwp5fejiFfSCGc5GsRrjifGwJe0y1JxW/9bb5F5X4ZEn/PycKFKHwJz0XJvw5S+s/l4mhSjtKuPf4Ugq4vrYya2h4LZ6pgozPeA2WzHQobOWUuhwOGe7Q+C6su8R3QfW0h/h5qVKcXe6O/96ykcRVkH1pjtTQSVidCSrUdaOzZ8Quz0NO4ujnf0X/SlXwF+RuaxhAfOLh3UUYrjIYf0FcGEDMXTWBjz2O+sQczxb3xeifLmSHrSarncFqXjuKlXT838Eg/cT2o08JhlBbwfIafeWK9Izhd28Cn8uWNrg9H+cGgX0sSwXyBLHB0/zkQU9ir54j1k2FhknQ8zeYPkGjDxENSca9aLJIaU/6s5YP+IqSYJ1EDtJH5BOj4c0wDy1BVflKcA20CnljBY="
    on_success: always
    on_failure: always
